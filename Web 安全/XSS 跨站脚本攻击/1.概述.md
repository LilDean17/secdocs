### XSS 类型

| **类型**            | **恶意脚本来源**               | **典型场景**                                                 |
| ------------------- | ------------------------------ | ------------------------------------------------------------ |
| **反射型 XSS**      | 当前 HTTP 请求（如 URL 参数）  | 用户点击含恶意参数的链接，服务器直接反射参数到页面（如搜索框未过滤）。 |
| **存储型 XSS**      | 网站数据库（如用户评论、留言） | 攻击者提交恶意内容存入数据库，其他用户访问时触发（如论坛恶意帖子）。 |
| **基于 DOM 的 XSS** | 客户端 JavaScript 代码逻辑漏洞 | 前端代码直接使用未过滤的用户输入（如 `innerHTML` 拼接数据），与服务器无关。 |

### XSS 危害

身份伪造：窃取 Cookie 冒充用户登录，执行敏感操作（如转账、修改密码）。

数据窃取：读取用户隐私数据（如聊天记录、邮件内容）。

恶意操作：强制用户执行操作（如发送垃圾信息、传播病毒）。

网站篡改：插入恶意广告、钓鱼内容或篡改页面布局（虚拟污损）。

XSS 攻击的实际影响取决于应用程序特性、数据敏感度及用户权限：匿名公开场景影响小，涉及敏感数据或高权限用户时危害严重，可能导致数据泄露或系统失控。

### PortSwigger 官方对 XSS 的解释

**XSS 漏洞有多常见？**XSS 漏洞非常常见，XSS 可能是出现频率最高的 Web 安全漏洞。

**XSS 攻击有多常见？**很难获得有关真实世界 XSS 攻击的可靠数据，但与其他漏洞相比，它可能被利用的频率较低。

**XSS 和 CSRF 有什么区别？**XSS 涉及导致网站返回恶意 JavaScript，而 CSRF 涉及诱使受害者用户发送恶意的 HTTP 请求。

**XSS 和 SQL 注入有什么区别？**XSS 是针对其他应用程序用户的客户端漏洞，而 SQL 注入是针对应用程序数据库的服务器端漏洞。

**如何在 PHP 中防止 XSS？**使用允许的字符白名单过滤您的输入，并使用类型提示或类型转换。使用 HTML 上下文和 HTML 上下文转义输出，或者 JavaScript 上下文的 JavaScript Unicode 转义。`htmlentities``ENT_QUOTES`

**如何在 Java 中防止 XSS？**使用允许字符的白名单过滤您的输入，并使用 Google Guava 等库对 HTML 上下文的输出进行 HTML 编码，或对 JavaScript 上下文使用 JavaScript Unicode 转义。