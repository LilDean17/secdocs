### Host 头

它指定了客户端要访问的域名。例如：访问`https://portswigger.net/web-security` 时，构造如下标头。

```
GET /web-security HTTP/1.1
Host: portswigger.net
```

作用

- **识别后端组件**：支持多个网站通过同一 IP 访问。

- **虚拟主机**：同一服务器托管多站点（如[a.co](https://a.com/)[m](https://a.com/)和[b.com](https://b.com/)），靠 Host 头区分请求，Apache/Nginx 配置需指定 ServerName 匹配。

- **中介路由**：负载均衡器或 CDN 依 Host 头转发请求，反向代理可能修改 Host 头，用X-Forwarded-Host保留原始值。

### Host 头漏洞测试

##### 提供任意的主机头

探测主机头注入漏洞时，首要步骤是用任意未识别域名替换 Host 头。正常修改 Host 头会因 DNS 解析不同 IP，导致与不同服务器通信，但 Burp Suite 可分离主机头与目标 IP，确保修改后的请求仍发往预期目标。

修改后可能出现两种情况：若仍能访问目标网站，可能因服务器配置了默认或备用选项，此时可研究应用对主机头的处理逻辑，挖掘可利用点；若出现 “无效主机头” 错误（尤其是通过 CDN 访问目标时），则需尝试其他技术。

##### 检查验证缺陷

请求可能因安全措施被拦截，而非返回 “无效主机头” 响应，比如部分网站验证主机头与 TLS 握手时的服务器名称指示（SNI）是否匹配。

此时应探究网站解析主机头的机制，寻找绕过验证的漏洞。例如，一些解析算法仅验证域名，忽略端口信息，可通过设置非数字端口，在保持域名不变的情况下访问目标应用，同时尝试通过端口注入负载。

