### kid 相关概述

通常用于从 jwks 中匹配 jwk。

但其结构未被 JWS 规范强制定义，可由开发者自定义为任意字符串（如数据库条目、JSON 文件条目或文件名）。

若服务器未对`kid`做安全校验，攻击者可能利用其触发目录遍历攻击，迫使服务器使用文件系统中的任意文件作为验证密钥，导致签名验证失效。

### 使用文件格式的密钥进行对称签名

如果某个系统是使用对称密钥进行签名，那么对称密钥可能以文件的形式存储在某个文件夹，而 kid 很有可能就是这个对称密钥的文件名。

```
{
    "kid": "../../path/to/file",
    "typ": "JWT",
    "alg": "HS256",
    "k": "asGsADas3421-dfh9DGN-AFDFDbasfd8-anfjkvc"
}
```

如上，那么开发者很可能获取 jwt 后，提取出 kid，然后在指定路径寻找密钥文件。

理论上，可以指定任意文件，但最简单的方法之一是使用`/dev/null` ，它存在于大多数 Linux 系统上。由于这是一个空文件，因此读取它将返回一个空字符串。因此，使用空字符串对令牌进行签名将产生有效的签名。

### 实验

生成一个内容为空的对称密钥

![image-20250509171620510](https://cdn.jsdelivr.net/gh/LilDean17/secdoc@main/Web%20%E5%AE%89%E5%85%A8/JWT%20%E6%BC%8F%E6%B4%9E/images/image-20250509171620510.png)

```
AA== 是空子节 base64 编码后的结果。
```

修改数据后，签名即可。

![image-20250509171738524](https://cdn.jsdelivr.net/gh/LilDean17/secdoc@main/Web%20%E5%AE%89%E5%85%A8/JWT%20%E6%BC%8F%E6%B4%9E/images/image-20250509171738524.png)